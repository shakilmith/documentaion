<!DOCTYPE html>
<html lang="en">
<head>
<!--meta tags for SEO-->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="JPQL Overview; Learn about Java Persistence Query Language.">
<meta name="keywords" content="JPQL, Java, Backend, Database, MySQL">
<meta name="author" content="shakilmith">

<!--include.js-->
<!-- meta tags for open graph protocol (og:title, og:image)-->
<meta property="og:type" content="website" />
<meta property="og:title" content="Html Tutorial" />
<meta property="og:description" content="JPQL Overview; Learn About Java Persistence Query Language" />
<meta property="og:site_name" content="codeinjar.com" />
<!--Image description-->
<!--
<meta property="og:image" content="https://example.com/rock.jpg" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="300" />
<meta property="og:image:height" content="300" />
-->




<!--include.js-->
<script src="https://file-hosting.dashnexpages.net/marketingstrategy/assets/js/include.js"></script>
  <!--HighlightJS-->
  <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/default.min.css">
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  
  <!-- and it's easy to individually load additional languages -->
  <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/languages/go.min.js"></script>
  

  <title>JPQL Overview | codeinjar.com</title>

  <style>
      *{
        box-sizing: border-box;
      }
      html, body{
        margin: 0px;
        padding: 0px;
      }
      
      .post-container{
        margin-left: 16px;
        margin-right: 16px;
        margin-top: 10px;
        margin-bottom: 10px;
        font-size: 16px;
        line-height: 1.5;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
      }
      
      pre code {
        background-color: #eee;
        border: 1px solid #999;
        display: block;
        padding: 8px;
        overflow: auto;
        border-left: 5px solid red;
        /* Add shadows to create the "card" effect */
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        transition: 0.3s;
        margin-top: 32px;
        margin-bottom: 23px;
    }
    .left-border{
        border-left: 3px solid red;
      }  
    
      .highlight-text{
        background-color: papayawhip;
        color: black;
        display: inline;
        }
        
      .highlight-section{
        box-sizing: border-box;
        background-color: papayawhip;
        border-left: 5px solid red;
        color: black;
        padding: 3px 8px 3px 8px;
      }
  
    .large-bold-text{
      font-size: 36px;
      font-weight: bold;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    }
    .medium-bold-text{
      font-size: 24px;
      font-weight: bold;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    }
    .small-bold-text{
      font-size: 18px;
      font-weight: bold;
      font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
    }
  
    /** Image style in tutorial pages
  * In desktop version, image will be centered
  * Mobile or tablet version, it will be full width
  */
  
    /* for mobile */
    .post-image-style{
      width: 100%; 
      height: auto;
      display: block;
      box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
      transition: 0.3s;
      margin-top: 24px;
      margin-bottom: 24px;
      box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);;
    }
    
    /* for desktop */
    @media screen and (min-width: 580px){
      .post-image-style{
          max-width: 50%;
          height: auto;
          display: block;
          margin-left: auto;
          margin-right: auto;
          margin-top: 50px;
          margin-bottom: 50px;
          border-radius: 10px;
      }
    }

  </style>
  
</head>
<body>

<!-- Top nav -->
<div include-html="https://file-hosting.dashnexpages.net/marketingstrategy/assets/html/header.html"></div>
  





  
<!--Post starts-->  
<div class="post-container">

<h1>JPQL overview</h1>


<p>
JPQL is an object oriented java persistence query language that can perform database operations from java code or application than in database tables. The JPQL commands are almost like SQL commands but the only difference between sql and JPQL is that, sql statements are held in database tables but JPQL statement operates in the application.
</p>


<p>
<ul>
<b>The key features of JPQL:</b>
<dl>
<dt>
  - JPQL is portable and platform independent and can be used in different datastores.
</dt>
<dt>
  - It can operates bulk update, delete operations without touching datastore.
</dt>
<dt>
  - JPQL can also perform join and aggregate operations like sql.
</dt>
<dt>
  - JPQL queries can be declared statically in metadata (inside the entity itself) or can be declared dynamically in code or business logic. (Below we will describe about it)
</dt>
<dt>
  - JPQL is used to define searches against persistent entities and store those entities in database independently.
</dt>
</dl>
</ul>
</p>


<p>
<b>
JPQL provides 2 methods that can be used to access database records.
</b>
</p>

<ul style="list-style-type: none;">
<li>
<p>
   1. <b>createQuery()</b> <br/>
     It is called dynamic query, used on the business logic.
</p>
<p>
     How to define createQuery method in the business logic? <br/>
     Query query = entityManager.createQuery("Select p.first_name from Person p);
</p>
</li>
<li>
<p>
  2. <b>@NamedQuery()</b> <br/>
     It is called static query and it is defined inside the entity itself. 
</p>
<p>
     How to define <b>@NamedQuery()</b> method inside the entity?
     <br/>
     @NamedQuery(name="find name", query="Select p.first_name from Person p") <br/>
     Then inside the business logic we have to mention the name to retrieve the records of exact table from database.
     Query query = em.createQuery("find name")
</p>
</li>
</ul>


<p>
<b>Note:</b> Here, entityManager is the instance of entity-manager interface.
</p>


<ul style="list-style-type: none;">
<p>
The following are the possible JPQL statements that can used on the queries:
</p>
<li>
  - <b>SELECT:</b> (Select p from Person p)
</li>

<li>
  - <b>SELECT:</b> (Select p from Peron p where p.
  id < 109) //using optional where clause
</li>

<li>
  - <b>Update:</b> (Update Person p SET p.salary = 2500 where p.id > 135) 
</li>
<li>
  - <b>DELETE:</b> (Delete p from Person p where p.id = 109) or (Delete from Person where p.id = 109)
</li>
</ul>

<p>
<b>Note:</b> Here, Person is the entity name, and p is the reference or alias of Person.
</p>

<ul style="list-style-type: none;">
<p>
In JPQL Select, Update, Delete statements may contains the following clauses (parameters):
</p>
<li>
  - Select clause (It determines the type of the objects or values to be selected)
</li>
<li>
  - From clause (It mentions the entity name or designate the domain type which expressions specified)
</li>
<li>
  - Entity reference ()
</li>
<li>
  - An optional Where clause (like SQL where statement, and it applies conditions which can be used to restrict the results that are returned by the query)
</li>
<li>
  - An optional Order By clause (Order by not OrderBy)
</li>
<li>
  - An optional Group By clause
<li>
<li>
  - An optional Having clause
<li>
  - Identifiers like Distinct, Like, Join, As, True or False.
</li>
</ul>


<p class="large-bold-text">
Simple Example Application that Demonstrate JPQL
</p>

<p>
Let's see an example of JPQL query creation. 
</p>

<p>
Suppose, we have a table called Person in mysql database. It contains properties like - 
id (primary key), firstName, lastName, age, gender, role, city and country.
</p>

<p>
Now guess, the person table has the following records with respective data.
</p>


<div>
<pre><code>
+-----+------+-----------+-----------+------------+--------+-----------+-------------------+
| id  | age  | city      | country   | first_name | gender | last_name | role              |
+-----+------+-----------+-----------+------------+--------+-----------+-------------------+
| 101 |   30 | Helsinki  | Finland   | Barney     | Male   | Harold    | Java Developer    |
| 102 |   45 | Kazan     | Russia    | Henry      | Male   | Vincent   | Java Developer    |
| 103 |   40 | Brussels  | Belgium   | Trevor     | Male   | Chris     | SQL Developer     |
| 104 |   29 | Sydney    | Australia | Alex       | Male   | David     | Python Developer  |
| 105 |   49 | Sydney    | Australia | Finn       | Male   | Dan       | Cleaner           |
| 106 |   45 | Melbourne | Australia | Sophia     | Female | Tiffany   | Graphic Designer  |
| 107 |   41 | Berlin    | Germany   | Chad       | Male   | Ralph     | Web developer     |
| 108 |   37 | Frakfurt  | Germany   | Aaron      | Male   | Chris     | JavaFX Developer  |
| 109 |   30 | Seville   | Spain     | Adam       | Male   | Chris     | Rust Developer    |
| 110 |   31 | Oslo      | Norway    | Alena      | Female | Lopez     | Backend Developer |
+-----+------+-----------+-----------+------------+--------+-----------+-------------------+
</code></pre>
</div>


<p>
And we want to get the person first_name column value which id is equivalent to 105
</p>


<p>
If you don't already have Person entity class let's refer this tutorial: <a href="https://codeinjar.com/first-jpa-application/" alt="Save new Entity into MySQL Database">Create Your First JPA Application with Maven</a>
</p>


<p class="large-bold-text">
Create Persistence Class for Retrieving Person Records from Person Table Using JPQL
</p>

<p>
So, now create a <b>FindPerson.java</b> class in <b>com.company.dao</b> package. We will use jpa (jakarta specific) Query interface to retrieve person tables data, for the time being only the person firstName (fistName will be converter first_name in mysql).
</p>


<p class="medium-bold-text">
Using createQuery method
</p>

<p>
<pre><code>package com.company.dao;

import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.Persistence;
import jakarta.persistence.Query;

import java.util.List;

public class FindPerson {
    public static void main(String[] args) {
        EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory(&quot;default&quot;);
        EntityManager entityManager =entityManagerFactory.createEntityManager();
        entityManager.getTransaction().begin(); //it will start the transaction

        //create jpa dynamic query using entity-manager createQuery() method
        //the JPQL commands must be specific to the entity (like property name)
        Query query = entityManager.createQuery(&quot;SELECT p.firstName FROM Person p&quot;); //Person is the entity name not the table name, and firsName also the property name not the column name, kindly recall this behavior

        @SuppressWarnings(&quot;unchecked&quot;)
        List&lt;String&gt; personList = query.getResultList(); //invoke the getResultList() method to retrieve list of values

        //iterate and then print the firstName values
        System.out.println(&quot;First Name of all Persons&quot;);
        for(String p: personList){
            System.out.println(p);
        }

        entityManager.getTransaction().commit(); //it will commit the transaction
        entityManager.close();
        entityManagerFactory.close();
    }
}</code></pre>
</p>


<p>
After executing or running the <b>FindPerson.java</b> class, in the console we will see list of names of person entity. It means, we successfully retrieve person tables data using JPQL.
</p>

<p>
<pre><code>First Name of all Persons
Barney
Henry
Trevor
Alex
Finn
Sophia
Chad
Aaron
Adam
Alena</code></pre>
</p>

<p>
Now, we will see how to retrieve the person records using the <b>@NamedQuery</b> method that is used inside the domain model than the business logic.
</p>

<p class="medium-bold-text">
Using @NamedQuery
</p>

<p>
Just open your entity class (in our case the Person.java class) and write the following <b>@NamedQuery</b> annotation right above the entity name or just write it after the <b>@Entity</b> annotation.
</p>

<p>
<b>Person.java</b>
</p>


<p>
<pre><code>@NamedQuery(name = "find firstName", query = "Select p.firstName from Person p")

//Such as
@Entity(name = "Person")
@Table(name = "person")
@NamedQuery(name = "find firstName", query = "Select p.first_name from Person p")
public class Person {
    //to-do-list
}</code></pre>
</p>


<p>
<b>Note:</b> Here, the name property value will used inside our <b>FindPerson.java</b> class to extract or retrieve data from the person table.
</p>

<p>
In this step, now open FindPerson.java class and remove the <b>createQuery</b> method instead write <b>@NamedQuery</b>
</p>

<p>
<pre><code>remove: Query query = entityManager.createQuery(&quot;SELECT p.firstName FROM Person p&quot;);
write instead: Query query = entityManager.createNamedQuery(&quot;find firstName&quot;); //parameter value of @NamedQuery annotation</code></pre>
</p>


<p>
You can see, we use the <b>"find firstName"</b> of @NamedQuery attribute value here as a reference. 
</p>


<p>
Now if you run the <b>FindPerson.java</b> class again you will get the same output like the previous one.
</p>

<p>
<pre><code>First Name of all Persons
Barney
Henry
Trevor
Alex
Finn
Sophia
Chad
Aaron
Adam
Alena</code></pre>
</p>


<p>
<b>Note:</b> If you do any mistake or the createNamedQuery("") value if not match with value of name parameter of <b>@CreateNamedQuery</b> annotation you will get error in the console.
Such as, 
</p>


<p>
<pre><code>No query is registered under the name</code></pre>
</p>

<p>
Anyway, it seems we get the same output, but instead of using <b>createQuery</b> method we have use <b>createNamedQuery</b> method.
</p>

<p>
<b>Note:</b> There may be pros and cons of using <b>createQuery</b> or <b>namedQuery</b> query methods, but you can use them interchangeably.
</p>

<p>
Though we get all the person records (first_name) but it is possible that we can filter our data that how to retrieve them from database table. Such as, based on id, name, age, country or using specific logic (set condition) to retrieve data.
</p>


<p>
For achieving this, we have to provide </p>WHERE</b> conditional command in our JPQL query methods. It's almost like SQL command. So, if you have basic knowledge of SQL commands, it will be easy enough for you. 
</p>

<p>
   Learn More: <a href="https://codeinjar.com/most-common-sql-commands" alt="Most Common SQL Commands">The most common SQL commands you should know.</a>
</p>

<p>
So, please open the <b>FindPerson.java</b> class and update your query method by using where command in order retrieve records based on certain condition.
</p>

<p class="medium-bold-text">
Getting specific person records based on primary key
</p>

<p>
<pre><code>//retrieve person record based on id
Query query = entityManager.createQuery(&quot;SELECT p from Person p WHERE p.id = 105&quot;);

Person p5 = (Person) query.getSingleResult();

//retrieve person firsName, lastName and role
System.out.println(&quot;First Name: &quot;+ p5.getFirstName());
System.out.println(&quot;Last Name: &quot;+ p5.getLastName());
System.out.println(&quot;Role: &quot;+ p5.getRole());</code></pre>
</p>

<p>
But the SELECT command in the createQuery method, selects all the properties from the database table. Such as, when we run the above class, the following message shows this scenario.
</p>

<p>
<pre><code>select
    p1_0.id,
    p1_0.age,
    p1_0.city,
    p1_0.country,
    p1_0.first_name,
    p1_0.gender,
    p1_0.last_name,
    p1_0.role 
from
    person p1_0 
where
    p1_0.id=105

First Name: Finn
Last Name: Dan
Role: Cleaner</code></pre>
</p>



<p class="medium-bold-text">
Retrieving firsName column value based on person primary key</p>
</p>

<p>
<pre><code>//retrieve person record based on id
Query query = entityManager.createQuery(&quot;SELECT p.firstName from Person p WHERE p.id = 105&quot;);

String p5 = (String) query.getSingleResult();
System.out.println(&quot;First Name: &quot;+ p5);

/*
* Output:
* First Name: Finn
*/</code></pre>
</p>


<p class="medium-bold-text">Retrieve person details who live in specific country (filtering by country)
</p>


<p>
<pre><code>Query query = entityManager.createQuery(&quot;SELECT p.firstName from Person p WHERE p.country = &#39;Australia&#39; &quot;);

@SuppressWarnings(&quot;unchecked&quot;)
List&lt;String&gt; personList = query.getResultList();

for(String p: personList){
    System.out.println(p);
}

/*
* Output:
* Alex
* Finn
* Sophia
*/</code></pre>
</p>

<p>
The above can also be written like this:
</p>


<p>
<pre><code>Query query = entityManager.createQuery("SELECT p from Person p WHERE p.country = 'Australia' ");

@SuppressWarnings("unchecked")
List<Person> personList = query.getResultList();

for(Person p: personList){
    System.out.println(p.getFirstName());
}</code></pre>
</p>

<p class="medium-bold-text">
Let's Filtering by Gender (retrieve only female person records)
</p>

<p>
<pre><code>Query query = entityManager.createQuery(&quot;SELECT p from Person p WHERE p.gender = &#39;Female&#39; &quot;);

@SuppressWarnings(&quot;unchecked&quot;)
List&lt;Person&gt; personList = query.getResultList();

System.out.println(&quot;First Name &quot;+&quot; &quot;+ &quot;Last Name&quot;+ &quot;\t&quot;+ &quot;Role&quot;);
for(Person p: personList){
    System.out.println(p.getFirstName() + &quot;\t\t&quot;+ p.getLastName()+ &quot;\t\t&quot;+p.getRole());
}

/**
* Output:
* First Name  Last Name	  Role
* Sophia		  Tiffany		  Graphic Designer
* Alena		    Lopez		    Backend Developer
*/</code></pre>
</p>


<p>
<b>Note:</b> Anyway, you see, we also provide (String) wrapper type externally while creating query reference variable, otherwise it means, we are going to extract String than Object. 
</p>

<p>
Thanks for reading this article. I will be happy if you check out yourself the features  JPQL provides.
</p>





<!--Post ends-->
</div>



<!--Footer container-->

<div include-html="https://file-hosting.dashnexpages.net/marketingstrategy/assets/html/footer.html">

</div>

<script>
includeHTML();
</script>
<!-- js script for opening and closing the nav-->

<script>

/* Set the width of the side navigation to 250px */
function openNav() {
document.getElementById("mySidenav").style.width = "100%";
}

/* Set the width of the side navigation to 0 */
function closeNav() {
document.getElementById("mySidenav").style.width = "0";
}
</script>

<!--invoke highlightJs-->
<script>hljs.highlightAll();</script> 


</body>
</html>