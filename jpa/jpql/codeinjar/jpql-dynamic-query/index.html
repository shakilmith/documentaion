<!DOCTYPE html>
<html lang="en">
<head>
<!--meta tags for SEO-->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="JPQL Dynamic Query; Learn How to Retrieve, Update or Delete data using JPQL Dynamic Query">
<meta name="keywords" content="JPQL, Java, Backend, MySQL">
<meta name="author" content="shakilmith">


<!--meta tags for open graph protocol (og:title, og:image)-->
<meta property="og:type" content="website" />
<meta property="og:title" content="JPQL Dynamic Query Tutorial" />
<meta property="og:description" content="JPQL Tutorial; Learn how to retrieve, update, delete records using jpql dynamic query; " />
<meta property="og:site_name" content="codeinjar.com" />
<!--Image description-->
<!--
<meta property="og:image" content="https://example.com/rock.jpg" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="300" />
<meta property="og:image:height" content="300" />
-->




<!--Include.js file-->
<script src="https://file-hosting.dashnexpages.net/marketingstrategy/assets/js/include.js"></script>
<!--HighlightJS-->
<link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/default.min.css">
<script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
  
<!-- and it's easy to individually load additional languages -->
<script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/languages/go.min.js"></script>
  



  <title>JPQL Dynamic Query | codeinjar.com</title>

  <style>
      *{
        box-sizing: border-box;
      }
      html, body{
        margin: 0px;
        padding: 0px;
      }
      
      .post-container{
        margin-left: 16px;
        margin-right: 16px;
        margin-top: 10px;
        margin-bottom: 10px;
        font-size: 16px;
        line-height: 1.5;
        font-family: Verdana, Geneva, Tahoma, sans-serif;
      }
      
      pre code {
        background-color: #eee;
        border: 1px solid #999;
        display: block;
        padding: 8px;
        overflow: auto;
        border-left: 5px solid red;
        /* Add shadows to create the "card" effect */
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        transition: 0.3s;
        margin-top: 32px;
        margin-bottom: 23px;
    }
    .left-border{
        border-left: 3px solid red;
      }  
    
      .highlight-text{
        background-color: papayawhip;
        color: black;
        display: inline;
        }
        
      .highlight-section{
        box-sizing: border-box;
        background-color: papayawhip;
        border-left: 5px solid red;
        color: black;
        padding: 3px 8px 3px 8px;
      }
  
    .large-bold-text{
      font-size: 36px;
      font-weight: bold;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    }
    .medium-bold-text{
      font-size: 24px;
      font-weight: bold;
      font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
    }
    .small-bold-text{
      font-size: 18px;
      font-weight: bold;
      font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
    }
  
    /** Image style in tutorial pages
  * In desktop version, image will be centered
  * Mobile or tablet version, it will be full width
  */
  
    /* for mobile */
    .post-image-style{
      width: 100%; 
      height: auto;
      display: block;
      box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
      transition: 0.3s;
      margin-top: 24px;
      margin-bottom: 24px;
      box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);;
    }
    
    /* for desktop */
    @media screen and (min-width: 580px){
      .post-image-style{
          max-width: 50%;
          height: auto;
          display: block;
          margin-left: auto;
          margin-right: auto;
          margin-top: 50px;
          margin-bottom: 50px;
          border-radius: 10px;
      }
    }

  </style>
  
</head>
<body>

<!-- Top nav -->
<div include-html="https://file-hosting.dashnexpages.net/marketingstrategy/assets/html/header.html"></div>
  





  
<!--Post starts-->  
<div class="post-container">

<h1>JPQL dynamic Query Tutorial</h1>


<p>
In this example application, we are going to explore JPQL dynamic query and how we can retrieve, update or delete data from our relational database using JPQL dynamic query method.
</p>

<p>
Before going to dive into the real example, we have to know little bit about jpql. <b>JPQL</b> means <b>java persistence query language</b>. JPQL provides two methods to retrieve, update, delete or filter data from our application instead of the database tables.
</p>


<div>
The key features of JPQL: 
<ul style="list-style-type: none">
<li>
  - JPQL is portable and platform independent and can be used in different datastores.
</li>
<li>
  - It can operates bulk update, delete operations without touching datastore.
</li>
<li>
  - JPQL can also perform join and aggregate operations like sql.
</li>
<li>
  - JPQL queries can be declared statically in metadata (inside the entity itself) or can be declared dynamically in code or business logic. (Below we will describe about it)
</li>
<li>
  - JPQL is used to define searches against persistent entities and store those entities in database independently.
</li>
</ul>
</div>


<div>
JPQL provides 2 methods that can be used to access database records.
<ul style="list-style-type: none;">
<li>
   1. <b>createQuery()</b> <br/>
     It is called dynamic query, used on the business logic.

     How to define createQuery method in the business logic?
     Query query = entityManager.createQuery("Select p.first_name from Person p);


</li> <br/>
<li>
  2. <b>@NamedQuery()</b> <br/>
     It is called static query and it is defined inside the entity itself. 

     How to define <b>@NamedQuery()</b> method inside the entity?
     @NamedQuery(name="find name", query="Select p.first_name from Person p")
     Then inside the business logic we have to mention the name to retrieve the records of exact table from database.
     Query query = em.createQuery("find name")
</li>
</ul>
</div>

<p>
Note: Here, entityManager is the instance of entity-manager interface.
</p>

<div>
The following are the possible JPQL statements that can be used on the queries:
<ul style="list-style-type: none;">
<li>
  - <b>SELECT:</b> (Select p from Person p)
</li>
<li>
  - <b>SELECT:</b> (Select p from Peron p where p.id < 109) //using optional where clause
</li>
<li>
  - <b>Update:</b> (Update Person p SET p.salary = 2500 where p.id > 135) 
</li>
<li>
  - <b>DELETE:</b> (Delete p from Person p where p.id = 109) or (Delete from Person where p.id = 109)
</li>
</ul>

<b>Note:</b> Here, Person is the entity name, p is the instance of the Peron class.
</div>




<div>
In JPQL Select, Update, Delete statements may contains the following clauses (parameters):

<ul style="list-style-type: none;">
<li>
  - Select clause (It determines the type of the objects or values to be selected)
</li>
<li>
  - From clause (It mentions the entity name or designate the domain type which expressions specified)
</li>
<li>
  - Entity reference ()
</li>
<li>
  - An optional Where clause (like SQL where statement, and it applies conditions which can be used to restrict the results that are returned by the query)
</li>
<li>
  - An optional Order By clause (Order by not OrderBy)
</li>
<li>
  - An optional Group By clause
</li>
<li>
  - An optional Having clause
</li>
<li>
  - Identifiers like Distinct, Like, Join, As, True or False.
</li>
</ul>
</div>



<p>
But in this post, we will see how to retrieve data from our relational database table using JPQL dynamic query means using <b>createQuery()</b> method.
</p>


<p class="large-bold-text">
Simple Example Application
</p>

<p>
Suppose, we have a table named Person in the mysql database. It contains properties like: id (primary key), firstName, lastName, age, gender, role, city and country.
</p>

<p>
<b>Note:</b> In your application, you must have entity class of <b>Person.java</b> and all the properties mentioned above. If you don't have the person entity class, create one with the respective properties, otherwise you can't retrieve data from the database.
</p>

<p>
For your favour, the Person entity class will look like:
</p>


<p>
<b>Person.java</b> entity class
</p>

<p>
<pre><code>package com.company.model;

import jakarta.persistence.*;

@Entity(name = &quot;Person&quot;)
@Table(name = &quot;person&quot;)
public class Person {
    @Id
    private int id;

    @Column(name = &quot;first_name&quot;)
    private String firstName;

    @Column(name = &quot;last_name&quot;)
    private String lastName;

    @Column(name = &quot;age&quot;)
    private int age;

    @Column(name = &quot;gender&quot;)
    private String gender;

    @Column(name = &quot;role&quot;)
    private String role;

    @Column(name = &quot;city&quot;)
    private String city;

    @Column(name = &quot;country&quot;)
    private String country;

    //constructors, getter and setter methods
}</code></pre>
</p>


<p>
Now guess, the person table has the following records with respective data.
</p>

<p>
<pre><code>+-----+------+-----------+-----------+------------+--------+-----------+-------------------+
| id  | age  | city      | country   | first_name | gender | last_name | role              |
+-----+------+-----------+-----------+------------+--------+-----------+-------------------+
| 101 |   30 | Helsinki  | Finland   | Barney     | Male   | Harold    | Java Developer    |
| 102 |   45 | Kazan     | Russia    | Henry      | Male   | Vincent   | Java Developer    |
| 103 |   40 | Brussels  | Belgium   | Trevor     | Male   | Chris     | SQL Developer     |
| 104 |   29 | Sydney    | Australia | Alex       | Male   | David     | Python Developer  |
| 105 |   49 | Sydney    | Australia | Finn       | Male   | Dan       | Cleaner           |
| 106 |   45 | Melbourne | Australia | Sophia     | Female | Tiffany   | Graphic Designer  |
| 107 |   41 | Berlin    | Germany   | Chad       | Male   | Ralph     | Web developer     |
| 108 |   37 | Frakfurt  | Germany   | Aaron      | Male   | Chris     | JavaFX Developer  |
| 109 |   30 | Seville   | Spain     | Adam       | Male   | Chris     | Rust Developer    |
| 110 |   31 | Oslo      | Norway    | Alena      | Female | Lopez     | Backend Developer |
+-----+------+-----------+-----------+------------+--------+-----------+-------------------+</code></pre>
</p>


<p>
And we want to retrieve all the first_name column value.
</p>
<p>
If you don't already have Person entity class let's refer this tutorial: 

<a href="https://codeinjar.com/how-to-create-jpa-entity/" alt="Create JPA Entity">Create Your First JPA Entity</a>
</p>

<p class="large-bold-text">
Create Persistence Class for Retrieving Person Records from Person Table Using JPQL
</p>


<p>
So, now create a <b>FindPerson.java</b> class in <b>com.company.dao</b> package. We will use jpa (jakarta specific) Query interface to retrieve person tables data, for the time being only the person firstName (fistName will be converter first_name in mysql).
</p>


<p>
Using createQuery method
</p>

<p>
<pre><code>package com.company.dao;

import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.Persistence;
import jakarta.persistence.Query;

import java.util.List;

public class FindPerson {
    public static void main(String[] args) {
        EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory(&quot;default&quot;);
        EntityManager entityManager =entityManagerFactory.createEntityManager();
        entityManager.getTransaction().begin(); //it will start the transaction

        //create jpa dynamic query using entity-manager createQuery() method
        //the JPQL commands must be specific to the entity (like property name)
        Query query = entityManager.createQuery(&quot;SELECT p.firstName FROM Person p&quot;); //Person is the entity name not the table name, and firsName also the property name not the column name, kindly recall this behavior

        @SuppressWarnings(&quot;unchecked&quot;)
        List&lt;String&gt; personList = query.getResultList(); //invoke the getResultList() method to retrieve list of values

        //iterate and then print the firstName values
        System.out.println(&quot;First Name of all Persons&quot;);
        for(String p: personList){
            System.out.println(p);
        }

        entityManager.getTransaction().commit(); //it will commit the transaction
        entityManager.close();
        entityManagerFactory.close();
    }
}</code></pre>
</p>


<p>
After executing or running the <b>FindPerson.java</b> class, in the console we will see list of names of person entity. It means, we successfully retrieve person tables data using <b>JPQL</b>.
</p>

<p>
<pre><code>First Name of all Persons
Barney
Henry
Trevor
Alex
Finn
Sophia
Chad
Aaron
Adam
Alena</code></pre>
</p>


<p>
Here you can see, how we can retrieve data using <b>JPQL Dynamic Query method</b> and we used the SQL like commands inside our application other than the database table.
</p>





<!--Post ends-->
</div>



<!--Footer container-->

<div include-html="https://file-hosting.dashnexpages.net/marketingstrategy/assets/html/footer.html">

</div>

<script>
includeHTML();
</script>
<!-- js script for opening and closing the nav-->

<script>

/* Set the width of the side navigation to 250px */
function openNav() {
document.getElementById("mySidenav").style.width = "100%";
}

/* Set the width of the side navigation to 0 */
function closeNav() {
document.getElementById("mySidenav").style.width = "0";
}
</script>

<!--invoke highlightJs-->
<script>hljs.highlightAll();</script> 


</body>
</html>